name: "java-build-upload-artifact"
description: "Builds a Java project and uploads the JAR as an artifact"


inputs:
  gradle-command:
    description: "The command executed by Gradle to build the project"
    default: "./gradlew clean shadowJar --no-daemon"
  java-version:
    description: "The Java version to build with"
    default: "21"
  java-distribution:
    description: "The Java distribution to build with"
    default: "temurin"
  release-version:
    description: "The version of the release"
    default: "${{ github.ref_name }}"

runs:
  using: "composite"
  steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up JDK
        uses: actions/setup-java@v4
        with:
          java-version: ${{ inputs.java-version }}
          distribution: ${{ inputs.java-distribution }}

      - name: Build with Gradle
        shell: "bash"
        env:
          MAVEN_USERNAME: ${{ secrets.MAVEN_USERNAME }}
          MAVEN_SECRET: ${{ secrets.MAVEN_SECRET }}
          RELEASE_VERSION: ${{ inputs.release-version }}
        run: "${{ inputs.gradle-command }}"

      - name: Upload JAR Artifact
        uses: actions/upload-artifact@v4
        with:
          name: built-jar
          path: build/libs/*.jar